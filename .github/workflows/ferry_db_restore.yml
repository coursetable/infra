name: Ferry DB Restore

on:
  workflow_dispatch:
    inputs:
      restore_date:
        description: 'Date to restore from (YYYY-MM-DD format, e.g., 2024-01-15). Leave empty for latest backup.'
        required: false
        type: string

jobs:
  backup:
    runs-on: self-hosted
    steps:
      - name: Ferry DB Restore
        run: |
          cd /home/app/infra/db
          git pull
          if [ -n "${{ github.event.inputs.restore_date }}" ]; then
            bash restore-ferry.sh "${{ github.event.inputs.restore_date }}"
          else
            bash restore-ferry.sh
          fi
